Database Schema Type,Prompt,Grount-Truth Query,Query Validation,Notes
Normal Format,"You are a very helpful databases expert. Generate the most accurate and efficient SQL query to calculate the total revenue generated by each `store_location` in January 2023 for coffee products (`product_category = 'Coffee'`) sold between 6:00 AM and 12:00 PM, grouped by `product_type`. The dataset table is called `dbo.Sales`. I'm using Microsoft SQL Server.

The dataset is provided in the following format:

transaction_id: Unique sequential ID representing an individual transaction
transaction_date: Date of the transaction (MM/DD/YY)
transaction_time: Timestamp of the transaction (HH:MM:SS)
transaction_qty: Quantity of items sold
store_id: Unique ID of the coffee shop where the transaction took place
store_location: Location of the coffee shop where the transaction took place
product_id: Unique ID of the product sold
unit_price: Retail price of the product sold
product_category: Description of the product category
product_type: Description of the product type
product_detail: Description of the product detail

Additional Notes:
1. Total Revenue is calculated as transaction_qty * unit_price.
2. ""Morning"" is defined as transactions occurring between 6:00 AM and 12:00 PM.
3. January 2023 corresponds to all transactions where the transaction_date is within 01/01/23 and 01/31/23.

Output Format:
Write the SQL query without explanations. Ensure the result includes the following columns: `store_location`, `product_type`, and `total_revenue`.","SELECT 
    store_location,
    product_type,
    SUM(transaction_qty * unit_price) AS total_revenue
FROM 
    dbo.Sales
WHERE 
    product_category = 'Coffee'
    AND transaction_date BETWEEN '01/01/2023' AND '01/31/2023'
    AND CAST(transaction_time AS TIME) BETWEEN '06:00:00' AND '12:00:00'
GROUP BY 
    store_location,
    product_type","Peter Ekler on 11/27/2024
",
Star Schema,"You are a very helpful databases expert. Generate the most accurate and most efficient SQL query to calculate the total revenue generated by each `store_location` in January 2023 for coffee products sold in the Morning period, grouped by `product_type`.

The data is organized in a star schema with the following tables:

1. Fact table (dbo.Fact_Sales) includes: { transaction_id (INT, Primary Key for each transaction), store_id (INT, Foreign Key to Dim_Store), product_id (INT, Foreign Key to Dim_Product), date_id (INT, Foreign Key to Dim_Date), time_id (INT, Foreign Key to Dim_Time), transaction_qty (INT, Quantity sold in the transaction), unit_price (DECIMAL, Price per unit of the product), and revenue (DECIMAL, Calculated as transaction_qty * unit_price)}.

2. Dimension tables are: dbo.Dim_Store: This table provides information on each store's ID, location, etc. Its rows are {store_id (INT, Primary Key for each store) and store_location (VARCHAR, Location (e.g., city, region))}. dbo.Dim_Product: Information on each product, its category, type, and details. The rows are {product_id (INT, Primary Key for each product), product_category (VARCHAR, Category of the product), product_type (VARCHAR, Type of product), product_detail (VARCHAR, Additional product information)}. dbo.Dim_Date: Breakdown of dates into meaningful components for time-based analysis. The rows are {date_id (INT, Surrogate Primary Key), date (DATE, Calendar date), day_of_week (VARCHAR, Day of the week (e.g., ""Monday"")), month (VARCHAR, Month (e.g., ""January"")), year (INT, Year (e.g., 2023)), and total_transactions. dbo.Dim_Time: Breakdown of time into hours or parts of the day. The rows are {time_id (INT, Surrogate Primary Key), transaction_time (TIME, Actual time of the transaction), hour (INT, Hour of the day), period_of_day (VARCHAR, Part of day (e.g., ""Morning"", ""Afternoon"")), and total transactions}}.

Additional Notes:
1. The Morning period corresponds to period_of_day = 'Morning' in the Dim_Time table.
2. January 2023 corresponds to month = 'January' and year = 2023 in the Dim_Date table.
3. Focus only on coffee products (product_category = 'Coffee').
4. I'm using Microsoft SQL Server.

Output Format:
Write the SQL query without explanations. Ensure the result includes the following columns: `store_location`, `product_type`, and `total_revenue`. ","SELECT 
    ds.store_location,
    dp.product_type,
    SUM(fs.revenue) AS total_revenue
FROM 
    dbo.Fact_Sales fs
INNER JOIN 
    dbo.Dim_Store ds ON fs.store_id = ds.store_id
INNER JOIN 
    dbo.Dim_Product dp ON fs.product_id = dp.product_id
INNER JOIN 
    dbo.Dim_Date dd ON fs.date_id = dd.date_id
INNER JOIN 
    dbo.Dim_Time dt ON fs.time_id = dt.time_id
WHERE 
    dd.month = 'January' AND dd.year = 2023
    AND dt.period_of_day = 'Morning'
    AND dp.product_category = 'Coffee'
GROUP BY 
    ds.store_location, dp.product_type
ORDER BY 
    ds.store_location, dp.product_type;","Peter Ekler on 12/03/2024
",